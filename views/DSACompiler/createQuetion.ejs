<%layout("layout/placement/boilerplate.ejs")%>
<body class="bg-light">
    <div class="container py-5">
        <div class="card shadow-lg border-0">
            <div class="card-header bg-white border-0 py-4">
                <div class="d-flex align-items-center">
                    <div class="bg-primary bg-opacity-10 p-3 rounded-circle me-3">
                        <i class="fas fa-plus-circle text-primary fs-4"></i>
                    </div>
                    <h1 class="h3 mb-0 fw-bold">Create New Question</h1>
                </div>
            </div>
            
            <div class="card-body px-5 py-4">
                <form id="questionForm" action="/dsa/addquestion" method="POST" class="needs-validation" novalidate>
                    <!-- Question Type -->
                    <div class="mb-4">
                        <label class="form-label fw-bold">Question Type <span class="text-danger">*</span></label>
                        <div class="btn-group w-100" role="group">
                            <input type="radio" class="btn-check" name="questionType" id="mcqType" value="MCQ" required>
                            <label class="btn btn-outline-primary" for="mcqType">
                                <i class="fas fa-list-ol me-2"></i>Multiple Choice
                            </label>
                            
                            <input type="radio" class="btn-check" name="questionType" id="codingType" value="CODING">
                            <label class="btn btn-outline-primary" for="codingType">
                                <i class="fas fa-code me-2"></i>Coding Problem
                            </label>
                        </div>
                    </div>

                    <!-- Common Fields -->
                    <div class="mb-4">
                        <label for="title" class="form-label fw-bold">Title <span class="text-danger">*</span></label>
                        <input type="text" class="form-control form-control-lg" id="title" name="title" required>
                    </div>

                    <div class="mb-4">
                        <label for="description" class="form-label fw-bold">Description <span class="text-danger">*</span></label>
                        <textarea class="form-control" id="description" name="description" rows="4" required></textarea>
                    </div>

                    <div class="row g-3 mb-4">
                        <div class="col-md-6">
                            <label for="difficulty" class="form-label fw-bold">Difficulty <span class="text-danger">*</span></label>
                            <select class="form-select" id="difficulty" name="difficulty" required>
                                <option value="" disabled selected>Select level</option>
                                <option value="Easy">Easy</option>
                                <option value="Medium">Medium</option>
                                <option value="Hard">Hard</option>
                            </select>
                        </div>
                        <div class="col-md-6">
                            <label for="tags" class="form-label fw-bold">Tags</label>
                            <input type="text" class="form-control" id="tags" name="tags" placeholder="Separate with commas" required>
                        </div>
                    </div>

                    <!-- MCQ Section -->
                    <div id="mcqSection" class="mb-4 d-none">
                        <div class="d-flex align-items-center mb-3">
                            <div class="bg-primary bg-opacity-10 p-2 rounded-circle me-2">
                                <i class="fas fa-list-ol text-primary"></i>
                            </div>
                            <h3 class="h5 mb-0 fw-bold">MCQ Options</h3>
                        </div>
                        
                        <div class="row g-3">
                            <div class="col-md-6">
                                <label for="option1" class="form-label">Option 1 <span class="text-danger">*</span></label>
                                <input type="text" class="form-control" id="option1" name="options[]" required>
                            </div>
                            <div class="col-md-6">
                                <label for="option2" class="form-label">Option 2 <span class="text-danger">*</span></label>
                                <input type="text" class="form-control" id="option2" name="options[]" required>
                            </div>
                            <div class="col-md-6">
                                <label for="option3" class="form-label">Option 3 <span class="text-danger">*</span></label>
                                <input type="text" class="form-control" id="option3" name="options[]" required>
                            </div>
                            <div class="col-md-6">
                                <label for="option4" class="form-label">Option 4 <span class="text-danger">*</span></label>
                                <input type="text" class="form-control" id="option4" name="options[]" required>
                            </div>
                        </div>
                        
                        <div class="mt-3">
                            <label for="correctAnswer" class="form-label">Correct Answer <span class="text-danger">*</span></label>
                            <select class="form-select" id="correctAnswer" name="correctAnswer" required>
                                <option value="" disabled selected>Select correct option</option>
                                <option value="1">Option 1</option>
                                <option value="2">Option 2</option>
                                <option value="3">Option 3</option>
                                <option value="4">Option 4</option>
                            </select>
                        </div>
                    </div>

                    <!-- Coding Section -->
                    <div id="codingSection" class="d-none">
                        <div class="d-flex align-items-center mb-3">
                            <div class="bg-primary bg-opacity-10 p-2 rounded-circle me-2">
                                <i class="fas fa-code text-primary"></i>
                            </div>
                            <h3 class="h5 mb-0 fw-bold">Coding Problem</h3>
                        </div>
                        
                        <div class="row g-3 mb-4">
                            <div class="col-md-6">
                                <label for="inputFormat" class="form-label">Input Format <span class="text-danger">*</span></label>
                                <textarea class="form-control" id="inputFormat" name="inputFormat" rows="3" required></textarea>
                            </div>
                            <div class="col-md-6">
                                <label for="outputFormat" class="form-label">Output Format <span class="text-danger">*</span></label>
                                <textarea class="form-control" id="outputFormat" name="outputFormat" rows="3" required></textarea>
                            </div>
                        </div>
                        
                        <div class="mb-4">
                            <label for="constraints" class="form-label">Constraints</label>
                            <textarea class="form-control" id="constraints" name="constraints" rows="2" required></textarea>
                        </div>
                        
                        <div class="row g-3 mb-4">
                            <div class="col-md-6">
                                <label for="timeLimit" class="form-label">Time Limit (seconds) <span class="text-danger">*</span></label>
                                <input type="number" class="form-control" id="timeLimit" name="timeLimit" value="2" min="1" required>
                            </div>
                            <div class="col-md-6">
                                <label for="memoryLimit" class="form-label">Memory Limit (MB) <span class="text-danger">*</span></label>
                                <input type="number" class="form-control" id="memoryLimit" name="memoryLimit" value="256" min="64" required>
                            </div>
                        </div>
                        
                        <div class="mb-4">
                            <label for="solution" class="form-label">Solution Explanation</label>
                            <textarea class="form-control" id="solution" name="solution" rows="4" required></textarea>
                        </div>
                        
                        <div class="d-flex align-items-center mb-3">
                            <div class="bg-primary bg-opacity-10 p-2 rounded-circle me-2">
                                <i class="fas fa-vial text-primary"></i>
                            </div>
                            <h3 class="h5 mb-0 fw-bold">Test Cases</h3>
                        </div>
                        
                        <div id="testCasesContainer" class="mb-3">
                            <!-- Test cases will be added here -->
                        </div>
                        
                        <button type="button" class="btn btn-outline-primary" onclick="addTestCase()">
                            <i class="fas fa-plus me-2"></i>Add Test Case
                        </button>
                    </div>

                    <div class="d-grid mt-5">
                        <button type="submit" class="btn btn-primary btn-lg py-3">
                            <i class="fas fa-save me-2"></i>Create Question
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script>
        // Initialize form
        document.addEventListener('DOMContentLoaded', () => {
            // Toggle sections based on question type
            document.querySelectorAll('input[name="questionType"]').forEach(radio => {
                radio.addEventListener('change', toggleQuestionType);
            });
            
            // Add first test case for coding questions
            addTestCase();
        });

        function toggleQuestionType() {
            const type = document.querySelector('input[name="questionType"]:checked').value;
            document.getElementById('mcqSection').classList.toggle('d-none', type !== 'MCQ');
            document.getElementById('codingSection').classList.toggle('d-none', type !== 'CODING');
            
            // Toggle required fields
            document.querySelectorAll('#mcqSection [required]').forEach(el => el.required = type === 'MCQ');
            document.querySelectorAll('#codingSection [required]').forEach(el => el.required = type === 'CODING');
        }

        function addTestCase() {
            const container = document.getElementById('testCasesContainer');
            const count = container.children.length + 1;
            
            const testCase = document.createElement('div');
            testCase.className = 'card mb-3';
            testCase.innerHTML = `
                <div class="card-header bg-light d-flex justify-content-between align-items-center">
                    <span class="badge bg-primary">Test Case #${count}</span>
                    <button type="button" class="btn btn-sm btn-link text-danger" onclick="this.closest('.card').remove()">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="card-body">
                    <div class="mb-3">
                        <label class="form-label">Input <span class="text-danger">*</span></label>
                        <textarea class="form-control" name="testCases[${count-1}][input]" required></textarea>
                    </div>
                    <div class="mb-0">
                        <label class="form-label">Output <span class="text-danger">*</span></label>
                        <textarea class="form-control" name="testCases[${count-1}][output]" required></textarea>
                    </div>
                </div>
            `;
            container.appendChild(testCase);
        }

        // Form validation
        document.getElementById('questionForm').addEventListener('submit', function(e) {
            if (!this.checkValidity()) {
                e.preventDefault();
                e.stopPropagation();
            }
            this.classList.add('was-validated');
        });
    </script>
</body>
</html>