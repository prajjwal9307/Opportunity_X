<%layout("layout/placement/boilerplate.ejs") %>

    <body class="bg-light">
        <!-- Hero Section -->
        <div class="bg-white py-5 shadow-sm">
            <div class="container text-center py-4">
                <div class="bg-primary bg-opacity-10 d-inline-flex p-3 rounded-circle mb-4">
                    <i class="fas fa-laptop-code text-primary fs-1"></i>
                </div>
                <h1 class="display-5 fw-bold mb-3">Upcoming Hackathons</h1>
                <p class="lead text-muted">Find and join the most exciting coding competitions</p>
            </div>
        </div>

        <!-- Main Content -->
        <div class="container py-5">
            <!-- Search and Filter -->
            <div class="card shadow-sm mb-5">
                <div class="card-body">
                    <div class="row g-3">
                        <div class="col-md-8">
                            <div class="input-group">
                                <span class="input-group-text bg-light"><i class="fas fa-search text-muted"></i></span>
                                <input type="text" class="form-control border-start-0" id="searchInput"
                                    placeholder="Search hackathons by title, theme, or venue...">
                            </div>
                        </div>
                        <div class="col-md-4">
                            <select class="form-select" id="typeFilter">
                                <option value="all">All Types</option>
                                <option value="Online">Online</option>
                                <option value="Offline">Offline</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Hackathons Grid -->
            <div class="row g-4" id="hackathonsContainer">
                <% if(allhackathon.length> 0) { %>
                    <% for(let hackathon of allhackathon) { %>
                        <div class="col-lg-4 col-md-6" data-title="<%= hackathon.title.toLowerCase() %>"
                            data-theme="<%= hackathon.theme.toLowerCase() %>"
                            data-venue="<%= hackathon.venue ? hackathon.venue.toLowerCase() : '' %>"
                            data-type="<%= hackathon.type %>">
                            <div class="card h-100 border-0 shadow-sm">
                                <div class="card-header bg-white">
                                    <div class="d-flex justify-content-between align-items-start">
                                        <span
                                            class="badge <%= new Date(hackathon.date) > new Date() ? 'bg-primary' : 'bg-secondary' %>">
                                            <%= new Date(hackathon.date)> new Date() ? 'Upcoming' : 'Past Event' %>
                                        </span>
                                        <%if(currentUser && currentUser.role==="admin"){%>
                                            <form action="/hackathon/delete/<%=hackathon._id%>" class="d-inline">
                                            <button type="submit" class="btn btn-sm btn-link text-danger p-0">
                                                <i class="far fa-trash-alt"></i>
                                            </button>
                                        </form>
                                        <%}%>
                                    </div>
                                    <h3 class="h5 mt-2 mb-0 fw-bold">
                                        <%= hackathon.title %>
                                    </h3>
                                </div>
                                <div class="card-body">
                                    <div class="d-flex align-items-center mb-3">
                                        <i class="far fa-calendar-alt text-muted me-2"></i>
                                        <small class="text-muted">
                                            <%= new Date(hackathon.date).toLocaleDateString('en-US', { weekday: 'short'
                                                , year: 'numeric' , month: 'short' , day: 'numeric' , hour: '2-digit' ,
                                                minute: '2-digit' }) %>
                                        </small>
                                    </div>

                                    <div class="d-flex align-items-center mb-3">
                                        <span
                                            class="badge <%= hackathon.type === 'Online' ? 'bg-info bg-opacity-10 text-info' : 'bg-warning bg-opacity-10 text-warning' %>">
                                            <i
                                                class="<%= hackathon.type === 'Online' ? 'fas fa-globe' : 'fas fa-map-marker-alt' %> me-1"></i>
                                            <%= hackathon.type %>
                                        </span>
                                    </div>

                                    <% if(hackathon.type==='Offline' && hackathon.venue) { %>
                                        <div class="d-flex mb-3">
                                            <i class="fas fa-building text-muted me-2 mt-1"></i>
                                            <small>
                                                <%= hackathon.venue %>
                                            </small>
                                        </div>
                                        <% } %>

                                            <p class="fst-italic mb-4">"<%= hackathon.theme %>"</p>

                                            <div class="d-flex justify-content-between align-items-center">
                                                <small class="text-muted">
                                                    Created: <%= new Date(hackathon.createdAt).toLocaleDateString() %>
                                                </small>
                                                <a href="/hackathon/<%=hackathon._id %>"
                                                    class="btn btn-sm btn-outline-primary">
                                                    View Details <i class="fas fa-arrow-right ms-1"></i>
                                                </a>
                                            </div>
                                </div>
                            </div>
                        </div>
                        <% } %>
                            <% } else { %>
                                <div class="col-12">
                                    <div class="card border-0 shadow-sm text-center py-5">
                                        <div class="bg-light bg-opacity-50 d-inline-flex p-3 rounded-circle mb-4">
                                            <i class="fas fa-laptop-code text-muted fs-1"></i>
                                        </div>
                                        <h3 class="h4 mb-3">No Hackathons Found</h3>
                                        <p class="text-muted mb-4">There are currently no hackathons available. Check
                                            back later!</p>
                            
                                    </div>
                                </div>
                                <% } %>
            </div>

            <!-- No Results State (hidden by default) -->
            <div class="row d-none" id="noResults">
                <div class="col-12">
                    <div class="card border-0 shadow-sm text-center py-5">
                        <div class="bg-light bg-opacity-50 d-inline-flex p-3 rounded-circle mb-4">
                            <i class="fas fa-search text-muted fs-1"></i>
                        </div>
                        <h3 class="h4 mb-3">No Matching Hackathons Found</h3>
                        <p class="text-muted mb-4">Try adjusting your search or filter criteria</p>
                        <button class="btn btn-outline-primary" onclick="resetSearch()">
                            <i class="fas fa-undo me-2"></i> Reset Search
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <script>
            // Simple search and filter functionality
            function filterHackathons() {
                const searchTerm = document.getElementById('searchInput').value.toLowerCase();
                const typeFilter = document.getElementById('typeFilter').value;
                const hackathonCards = document.querySelectorAll('#hackathonsContainer > .col-lg-4');
                let visibleCount = 0;

                hackathonCards.forEach(card => {
                    const matchesSearch = searchTerm === '' ||
                        card.dataset.title.includes(searchTerm) ||
                        card.dataset.theme.includes(searchTerm) ||
                        card.dataset.venue.includes(searchTerm);

                    const matchesType = typeFilter === 'all' || card.dataset.type === typeFilter;

                    if (matchesSearch && matchesType) {
                        card.classList.remove('d-none');
                        visibleCount++;
                    } else {
                        card.classList.add('d-none');
                    }
                });

                // Show no results message if needed
                document.getElementById('noResults').classList.toggle('d-none', visibleCount > 0 ||
                    (searchTerm === '' && typeFilter === 'all'));
            }

            // Reset search function
            window.resetSearch = function () {
                document.getElementById('searchInput').value = '';
                document.getElementById('typeFilter').value = 'all';
                filterHackathons();
            };

            // Add event listeners
            document.getElementById('searchInput').addEventListener('input', filterHackathons);
            document.getElementById('typeFilter').addEventListener('change', filterHackathons);
        </script>
        <style>

            .card {
                transition: transform 0.3s ease, box-shadow 0.3s ease;
            }

            .card:hover {
                transform: translateY(-5px);
                box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1) !important;
            }
        </style>
    </body>

    </html>